<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: denver                         *-->
<!--*  Palette: ice-fire                     *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Arnoldi iteration</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Understanding More Linear Algebra">
<meta property="book:author" content="David Austin">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.9.0';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.a5f1dc7727a1aa22.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.014cb392a13bd045.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.8141ae22fd347e48.css">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script src="_static/pretext/js/lti_iframe_resizer.js"></script><script async="" src="https://cse.google.com/cse.js?cx=015103900096539427448:ngwuia10qci"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body id="umla" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Understanding More Linear Algebra</span></a></h1>
<p class="byline">David Austin</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchwrapper" role="search"><div class="gcse-search"></div></div>
<div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-qr.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="chap-numerical.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="backmatter.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\nul}{\operatorname{nul}}
\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\C}{\mathbb C}
\newcommand{\R}{\mathbb R}
\newcommand{\avec}{{\mathbf a}}
\newcommand{\bvec}{{\mathbf b}}
\newcommand{\cvec}{{\mathbf c}}
\newcommand{\dvec}{{\mathbf d}}
\newcommand{\dtil}{\widetilde{\mathbf d}}
\newcommand{\evec}{{\mathbf e}}
\newcommand{\fvec}{{\mathbf f}}
\newcommand{\nvec}{{\mathbf n}}
\newcommand{\pvec}{{\mathbf p}}
\newcommand{\qvec}{{\mathbf q}}
\newcommand{\svec}{{\mathbf s}}
\newcommand{\tvec}{{\mathbf t}}
\newcommand{\uvec}{{\mathbf u}}
\newcommand{\vvec}{{\mathbf v}}
\newcommand{\wvec}{{\mathbf w}}
\newcommand{\xvec}{{\mathbf x}}
\newcommand{\yvec}{{\mathbf y}}
\newcommand{\zvec}{{\mathbf z}}
\newcommand{\rvec}{{\mathbf r}}
\newcommand{\mvec}{{\mathbf m}}
\newcommand{\zerovec}{{\mathbf 0}}
\newcommand{\onevec}{{\mathbf 1}}
\newcommand{\real}{{\mathbb R}}
\newcommand{\complex}{\mathbb C}
\newcommand{\field}{\mathbb F}
\newcommand{\pbb}{\mathbb P}
\newcommand{\poly}{\mathbb P}
\newcommand{\basis}[2]{#1_1,#1_2,\ldots,#1_{#2}}
\newcommand{\conjugate}[1]{\overline{#1}}
\newcommand{\conj}[1]{\overline{#1}}
\newcommand{\twovec}[2]{\left[\begin{array}{r}#1 \\ #2
\end{array}\right]}
\newcommand{\ctwovec}[2]{\left[\begin{array}{c}#1 \\ #2
\end{array}\right]}
\newcommand{\threevec}[3]{\left[\begin{array}{r}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\cthreevec}[3]{\left[\begin{array}{c}#1 \\ #2 \\ #3
\end{array}\right]}
\newcommand{\fourvec}[4]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\cfourvec}[4]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\ #4
\end{array}\right]}
\newcommand{\fivevec}[5]{\left[\begin{array}{r}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\cfivevec}[5]{\left[\begin{array}{c}#1 \\ #2 \\ #3 \\
#4 \\ #5 \\ \end{array}\right]}
\newcommand{\mattwo}[4]{\left[\begin{array}{rr}#1 \amp #2 \\ #3 \amp #4 \\ \end{array}\right]}
\newcommand{\laspan}[1]{\operatorname{Span}\{#1\}}
\newcommand{\bcal}{{\cal B}}
\newcommand{\ccal}{{\cal C}}
\newcommand{\dcal}{{\cal D}}
\newcommand{\ecal}{{\cal E}}
\newcommand{\scal}{{\cal S}}
\newcommand{\wcal}{{\cal W}}
\newcommand{\ecal}{{\cal E}}
\newcommand{\fcal}{{\cal F}}
\newcommand{\kcal}{{\cal K}}
\newcommand{\coords}[2]{\left\{#1\right\}_{#2}}
\newcommand{\gray}[1]{\color{gray}{#1}}
\newcommand{\lgray}[1]{\color{lightgray}{#1}}
\newcommand{\go}{\gray{1}}
\newcommand{\gz}{\gray{0}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\row}{\operatorname{Row}}
\newcommand{\col}{\operatorname{Col}}
\renewcommand{\deg}{\operatorname{deg}}
\newcommand{\range}{\operatorname{range}}
\newcommand{\tr}{\operatorname{tr}}
\newcommand{\var}{\text{Var}}
\newcommand{\corr}{\text{corr}}
\newcommand{\len}[1]{\left|#1\right|}
\newcommand{\bbar}{\overline{\bvec}}
\newcommand{\bhat}{\widehat{\bvec}}
\newcommand{\bperp}{\bvec^\perp}
\newcommand{\xhat}{\widehat{\xvec}}
\newcommand{\vhat}{\widehat{\vvec}}
\newcommand{\uhat}{\widehat{\uvec}}
\newcommand{\what}{\widehat{\wvec}}
\newcommand{\Sighat}{\widehat{\Sigma}}
\newcommand{\inner}[2]{\langle #1,#2\rangle}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter">
<div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-colophon"><div class="toc-title-box"><a href="front-colophon.html" class="internal"><span class="title">Colophon</span></a></div></li>
<li class="toc-item toc-preface"><div class="toc-title-box"><a href="frontmatter-5.html" class="internal"><span class="title">Preface</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-vs.html" class="internal"><span class="codenumber">1</span> <span class="title">Vector spaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-vs-intro.html" class="internal"><span class="codenumber">1.1</span> <span class="title">Vector spaces</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vs-intro.html#sec-vs-intro-3" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Vector spaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vs-intro.html#sec-vs-intro-4" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Linear combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vs-intro.html#sec-vs-intro-5" class="internal"><span class="codenumber">1.1.3</span> <span class="title">Bases</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-vs-intro.html#sec-vs-intro-6" class="internal"><span class="codenumber">1.1.4</span> <span class="title">Sums of subspaces</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-lt-intro.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Linear transformations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-lt-intro.html#sec-lt-intro-3" class="internal"><span class="codenumber">1.2.1</span> <span class="title">Linear transformations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-lt-intro.html#sec-lt-intro-4" class="internal"><span class="codenumber">1.2.2</span> <span class="title">The null space and range</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-lt-intro.html#sec-lt-intro-5" class="internal"><span class="codenumber">1.2.3</span> <span class="title">Vector space isomorphisms</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-lt-intro.html#sec-lt-intro-6" class="internal"><span class="codenumber">1.2.4</span> <span class="title">Representing linear transformations with matrices</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-lt-intro.html#sec-lt-intro-7" class="internal"><span class="codenumber">1.2.5</span> <span class="title">Dual spaces</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-orthogonal.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Inner products</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal.html#sec-orthogonal-3" class="internal"><span class="codenumber">1.3.1</span> <span class="title">Inner products</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal.html#sec-orthogonal-4" class="internal"><span class="codenumber">1.3.2</span> <span class="title">Orthogonality</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal.html#subsec-cauchy-schwarz" class="internal"><span class="codenumber">1.3.3</span> <span class="title">The Cauchy-Schwarz inequality</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-orthogonal.html#subsec-adjoint" class="internal"><span class="codenumber">1.3.4</span> <span class="title">The adjoint of a linear transformation</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-polys.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The minimal polynomial</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-polys.html#sec-polys-3" class="internal"><span class="codenumber">1.4.1</span> <span class="title">Properties of Polynomials</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-polys.html#sec-polys-4" class="internal"><span class="codenumber">1.4.2</span> <span class="title">Invariant subspaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-polys.html#sec-polys-5" class="internal"><span class="codenumber">1.4.3</span> <span class="title">The minimal polynomial of a vector</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-polys.html#sec-polys-6" class="internal"><span class="codenumber">1.4.4</span> <span class="title">The minimal polynomial of an operator</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-std-forms.html" class="internal"><span class="codenumber">2</span> <span class="title">Standard forms</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-upper.html" class="internal"><span class="codenumber">2.1</span> <span class="title">Upper triangular matrices</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-spectral.html" class="internal"><span class="codenumber">2.2</span> <span class="title">The Spectral Theorem</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-spectral.html#sec-spectral-3" class="internal"><span class="codenumber">2.2.1</span> <span class="title">The Schur decomposition</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-spectral.html#sec-spectral-4" class="internal"><span class="codenumber">2.2.2</span> <span class="title">Self-adjoint operators</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-nilpotent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Nilpotent operators</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-nilpotent.html#subsec-nul-powers" class="internal"><span class="codenumber">2.3.1</span> <span class="title">Null spaces of powers</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-nilpotent.html#sec-nilpotent-4" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Nilpotent operators</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-jordan.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Generalized eigenvectors</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jordan.html#sec-jordan-3" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Generalized eigenvectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jordan.html#sec-jordan-4" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Complex Vector Spaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-jordan.html#sec-jordan-5" class="internal"><span class="codenumber">2.4.3</span> <span class="title">Jordan form</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="chap-numerical.html" class="internal"><span class="codenumber">3</span> <span class="title">Numerical linear algebra</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-power.html" class="internal"><span class="codenumber">3.1</span> <span class="title">The power method</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power.html#sec-power-3" class="internal"><span class="codenumber">3.1.1</span> <span class="title">The power method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power.html#sec-power-4" class="internal"><span class="codenumber">3.1.2</span> <span class="title">The inverse power method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-power.html#sec-power-5" class="internal"><span class="codenumber">3.1.3</span> <span class="title">The shifted inverse power method</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-qr.html" class="internal"><span class="codenumber">3.2</span> <span class="title">QR methods</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-qr.html#sec-qr-3" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Using orthogonality</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-qr.html#sec-qr-4" class="internal"><span class="codenumber">3.2.2</span> <span class="title">The QR Method</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-qr.html#sec-qr-5" class="internal"><span class="codenumber">3.2.3</span> <span class="title">The shifted QR algorithm</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-arnoldi.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Arnoldi iteration</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-arnoldi.html#sec-arnoldi-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Arnoldi iteration</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-arnoldi.html#sec-arnoldi-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Krylov subspaces</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-arnoldi.html#sec-arnoldi-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Eigenvalues and Arnoldi iteration</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-arnoldi.html#sec-arnoldi-6" class="internal"><span class="codenumber">3.3.4</span> <span class="title">A working example</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-arnoldi"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.3</span><span class="space"> </span><span class="title">Arnoldi iteration</span>
</h2>
<section class="introduction" id="sec-arnoldi-2"><div class="para logical" id="sec-arnoldi-2-1">
<div class="para">The <span class="process-math">\(QR\)</span> algorithm that we developed in the <a href="sec-qr.html" class="internal" title="Section 3.2: QR methods">previous section</a> is a general purpose algorithm for finding all the eigenvalues of a symmetric matrix.  We now return to the problem we stated at the beginning of this chapter.  We assume that</div>
<ul class="disc" id="sec-arnoldi-2-1-3">
<li id="sec-arnoldi-2-1-3-1">
<div class="para" id="sec-arnoldi-2-1-3-1-1">
<span class="process-math">\(A\)</span> is an <span class="process-math">\(m\times m\)</span> matrix, where <span class="process-math">\(m\)</span> is possibly huge, and <span class="process-math">\(A\)</span> is not necessarily symmetric but is possibly sparse.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-2-1-3-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-2-1-3-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-arnoldi-2-1-3-2">
<div class="para" id="sec-arnoldi-2-1-3-2-1">We do not want to store the entire matrix in a computer, but instead we assume that we can efficiently compute <span class="process-math">\(A\xvec\)</span> for any vector <span class="process-math">\(\xvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-2-1-3-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-2-1-3-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-2-2">We will develop techniques for approximating the largest eigenvalues of <span class="process-math">\(A\)</span> and for approximating the solution of <span class="process-math">\(A\xvec = \bvec\text{.}\)</span>  Two key ideas will be the use of Krylov subspaces, which were introduced in <a href="sec-polys.html#definition-krylov" class="xref" data-knowl="./knowl/xref/definition-krylov.html" data-reveal-label="Reveal" data-close-label="Close" title="Definition 1.4.22: Krylov subspace">Definition 1.4.22</a> but which we will revisit soon in more detail, and Arnoldi iteration, which will produce an orthonormal basis for a Krylov subspace.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></section><section class="subsection" id="sec-arnoldi-3"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.3.1</span><span class="space"> </span><span class="title">Arnoldi iteration</span>
</h3>
<div class="para" id="sec-arnoldi-3-2">Since we are interested in computing the eigenvalues of a matrix, we may remember that <a href="sec-upper.html#prop-complex-upper" class="xref" data-knowl="./knowl/xref/prop-complex-upper.html" data-reveal-label="Reveal" data-close-label="Close" title="Proposition 2.1.4">Proposition 2.1.4</a> tells us that any complex matrix is similar to an upper triangular matrix. The diagonal entries in the upper triangular matrix would then give us the eigenvalues.  This is also true for real matrices as long as we allow complex arithmetic.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-3-3">
<div class="para">Unfortunately, there is not a computationally feasible algorithm to produce an upper triangular matrix similar to <span class="process-math">\(A\)</span> given our assumptions. However, we may relax the condition somewhat and consider <em class="emphasis">Hessenberg</em> matrices, which are matrices having the following, almost-upper triangular form:</div>
<div class="displaymath process-math">
\begin{equation*}
H=\begin{bmatrix}
* \amp * \amp * \amp \ldots \amp * \amp * \\
* \amp * \amp * \amp \ldots \amp * \amp * \\
0 \amp * \amp * \amp \ldots \amp * \amp * \\
0 \amp 0 \amp * \amp \ldots \amp * \amp * \\
\vdots \amp \vdots \amp \amp \ddots \amp * \amp * \\
0 \amp 0 \amp 0 \amp \ldots \amp * \amp * \\
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">That is, a Hessenberg matrix is upper triangular except for nonzero entries that could live just below the diagonal.  If we are given a square matrix <span class="process-math">\(A\text{,}\)</span> it turns out there are several computationally feasible ways to find a Hessenberg matrix similar to <span class="process-math">\(A\text{.}\)</span>  One way that may be familiar involves Householder reflections.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-3-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-3-4">However, we assume we are in the situation where we do not have access to the matrix and that we can multiply <span class="process-math">\(A\xvec\)</span> for any vector <span class="process-math">\(\xvec\text{.}\)</span>  In language from the earlier part of our course, we know the operator defined by <span class="process-math">\(A\text{,}\)</span> but not <span class="process-math">\(A\)</span> itself.  A technique known as <em class="emphasis">Arnoldi iteration</em> allows us to find a unitary matrix <span class="process-math">\(Q\)</span> and a Hessenberg matrix <span class="process-math">\(H\)</span> such that <span class="process-math">\(A=QHQ^*\text{.}\)</span>  If we work with real matrices, we find an orthogonal matrix <span class="process-math">\(Q\)</span> with <span class="process-math">\(A=QHQ^T\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-3-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-3-5">
<div class="para">We have</div>
<div class="displaymath process-math">
\begin{equation*}
Q = \begin{bmatrix}
\qvec_1 \amp \qvec_2 \amp \ldots \amp \qvec_m
\end{bmatrix}
\end{equation*}
</div>
<div class="para">and</div>
<div class="displaymath process-math">
\begin{equation*}
H=\begin{bmatrix}
h_{11} \amp h_{12} \amp h_{13} \amp \ldots \amp h_{1,m-1} \amp h_{1m} \\
h_{21} \amp h_{22} \amp h_{23} \amp \ldots \amp h_{2,m-1} \amp h_{2m} \\
0 \amp h_{32} \amp h_{33} \amp \ldots \amp h_{3,m-1} \amp h_{3m} \\
\vdots \amp \vdots \amp \amp \ddots \amp \vdots \amp \vdots \\
0 \amp 0 \amp 0 \amp \ldots \amp h_{m-1,m} \amp h_{mm} \\
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">We begin by rewriting <span class="process-math">\(A=QHQ^T\)</span> as <span class="process-math">\(AQ=QH\)</span> so that</div>
<div class="displaymath process-math">
\begin{equation*}
AQ=\begin{bmatrix}
A\qvec_1\amp A\qvec_2 \amp \ldots \amp A\qvec_n
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">This leads to the expressions</div>
<div class="displaymath process-math" id="sec-arnoldi-3-5-6">
\begin{align*}
A\qvec_1 \amp = h_{11}\qvec_1 + h_{21}\qvec_2\\
A\qvec_2 \amp = h_{12}\qvec_1 + h_{22}\qvec_2 + h_{32}\qvec_3\\
\vdots \amp = \vdots\\
A\qvec_n \amp = h_{n1}\qvec_1 + h_{n2}\qvec_2 + \ldots +
h_{nn}\qvec_n + h_{n+1,n}\qvec_{n+1}\\
\vdots \amp = \vdots\\
A\qvec_m \amp = h_{m1}\qvec_1 + h_{m2}\qvec_2 + \ldots +
h_{mm}\qvec_n\text{.}
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-3-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="example example-like" id="example-arnoldi"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.3.1</span><span class="period">.</span>
</h4>
<div class="para logical" id="example-arnoldi-1-1">
<div class="para">Rather than developing a general explanation for finding <span class="process-math">\(Q\)</span> and <span class="process-math">\(H\text{,}\)</span> we will demonstrate with an example.  Suppose that <span class="process-math">\(A=\begin{bmatrix}
1 \amp -2 \amp 3 \\
-2 \amp 4 \amp 2 \\
3 \amp 2 \amp -1 \\
\end{bmatrix}
\text{.}\)</span>  We choose any nonzero vector <span class="process-math">\(\vvec\)</span> and define</div>
<div class="displaymath process-math">
\begin{equation*}
\qvec_1 = \frac{1}{\len{\vvec}}\vvec\text{.}
\end{equation*}
</div>
<div class="para">We will choose <span class="process-math">\(\vvec=\threevec100\)</span> so that <span class="process-math">\(\qvec_1=\threevec100\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-2">
<div class="para">Our first expression is</div>
<div class="displaymath process-math">
\begin{equation*}
A\qvec_1 = h_{11}\qvec_1 + h_{21}\qvec_2\text{.}
\end{equation*}
</div>
<div class="para">Remember that the vectors <span class="process-math">\(\qvec_i\)</span> will be the columns of an orthogonal matrix, which means that they form an orthonormal set.  Therefore,</div>
<div class="displaymath process-math">
\begin{equation*}
(A\qvec_1)\cdot\qvec_1 = h_{11}\qvec_1\cdot\qvec_1 +
h_{21}\qvec_2\cdot\qvec_1 = h_{11}\text{.}
\end{equation*}
</div>
<div class="para">That is, we find</div>
<div class="displaymath process-math">
\begin{equation*}
h_{11}=\qvec_1\cdot(A\qvec_1) = r(A,\qvec_1)\text{,}
\end{equation*}
</div>
<div class="para">so we see that <span class="process-math">\(h_{11}\)</span> is a Rayleigh quotient, which is encouraging.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para" id="example-arnoldi-1-3">In our example, we have <span class="process-math">\(A\qvec_1 = \cthreevec1{-2}3\)</span> so that <span class="process-math">\(h_{11} = \qvec_1\cdot(A\qvec_1) = 1\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-4">
<div class="para">Rearranging the expression for <span class="process-math">\(A\qvec_1\text{,}\)</span> we have</div>
<div class="displaymath process-math">
\begin{equation*}
h_{21}\qvec_2 = A\qvec_1 - h_{11}\qvec_1= \cthreevec0{-2}{3}\text{.}
\end{equation*}
</div>
<div class="para">Because <span class="process-math">\(\qvec_2\)</span> has unit length, we have</div>
<div class="displaymath process-math">
\begin{equation*}
h_{21} = \len{A\qvec_1 - h_{11}\qvec_1}
\end{equation*}
</div>
<div class="para">so that <span class="process-math">\(h_{21} = \sqrt{13}\)</span> and then</div>
<div class="displaymath process-math">
\begin{equation*}
\qvec_2 = \frac{1}{h_{21}}(A\qvec_1 - h_{11}\qvec_1)
\end{equation*}
</div>
<div class="para">or <span class="process-math">\(\qvec_2 = \frac{1}{\sqrt{13}}\cthreevec0{-2}3\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-5">
<div class="para">We now repeat the same process using the second expression</div>
<div class="displaymath process-math">
\begin{equation*}
A\qvec_2 = h_{12}\qvec_1+h_{22}\qvec_2+h_{32}\qvec_3\text{.}
\end{equation*}
</div>
<div class="para">In particular,</div>
<div class="displaymath process-math">
\begin{equation*}
h_{12}=(A\qvec_2)\cdot\qvec_1,\hspace{12pt}
h_{22}=(A\qvec_2)\cdot\qvec_2=r(A,\qvec_2)
\end{equation*}
</div>
<div class="para">so that, once again, <span class="process-math">\(h_{22}\)</span> is a Rayleigh quotient.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para" id="example-arnoldi-1-6">In our example, <span class="process-math">\(A\qvec_2 =
\frac{1}{\sqrt{13}}\cthreevec{13}{-2}{-7}\)</span> and hence <span class="process-math">\(h_{12}=\sqrt{13}\)</span> and <span class="process-math">\(h_{22}=-\frac{17}{13}\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-7">
<div class="para">Rearranging the expression for <span class="process-math">\(A\qvec_2\)</span> shows that</div>
<div class="displaymath process-math">
\begin{equation*}
h_{32}\qvec_3 = A\qvec_2-h_{12}\qvec_1-h_{22}\qvec_2=
\cthreevec{0}{-\frac{60}{13\sqrt{13}}}{-\frac{40}{13\sqrt{13}}}\text{.}
\end{equation*}
</div>
<div class="para">Therefore, <span class="process-math">\(h_{32}=\frac{20}{13}\)</span> and <span class="process-math">\(\qvec_3=\cthreevec{0}{-\frac{3}{\sqrt{13}}}{-\frac{2}{\sqrt{13}}}\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-8">
<div class="para">Notice that <span class="process-math">\(\qvec_1\text{,}\)</span> <span class="process-math">\(\qvec_2\text{,}\)</span> and <span class="process-math">\(\qvec_3\)</span> form a basis for <span class="process-math">\(\real^3\)</span> so we have all three columns for the matrix <span class="process-math">\(Q\text{.}\)</span> Our final expression is</div>
<div class="displaymath process-math">
\begin{equation*}
A\qvec_3=h_{13}\qvec_1 + h_{23}\qvec_2 + h_{33}\qvec_3\text{,}
\end{equation*}
</div>
<div class="para">which gives</div>
<div class="displaymath process-math" id="example-arnoldi-1-8-7">
\begin{align*}
h_{13}\amp=(A\qvec_3)\cdot\qvec_1 =0\\
h_{23}\amp=(A\qvec_3)\cdot\qvec_2 =\frac{20}{13}\\
h_{33}\amp=(A\qvec_3)\cdot\qvec_3 =\frac{56}{13}\text{.}
\end{align*}
</div>
<div class="para">This leaves us with</div>
<div class="displaymath process-math">
\begin{equation*}
Q = \begin{bmatrix}
1 \amp 0 \amp 0 \\
0 \amp -\frac{2}{\sqrt{13}} \amp -\frac{3}{\sqrt{13}} \\
0 \amp \frac{3}{\sqrt{13}} \amp -\frac{2}{\sqrt{13}} \\
\end{bmatrix},
\hspace{12pt}
H = \begin{bmatrix}
1 \amp \sqrt{13} \amp 0 \\
\sqrt{13} \amp -\frac{17}{13} \amp \frac{20}{13} \\
0 \amp \frac{20}{13} \amp \frac{56}{13} \\
\end{bmatrix}
\end{equation*}
</div>
<div class="para">from which we can check that <span class="process-math">\(A=QHQ^T\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div> <div class="para logical" id="example-arnoldi-1-9">
<div class="para">Notice that our original matrix <span class="process-math">\(A=\begin{bmatrix}
1 \amp -2 \amp 3 \\
-2 \amp 4 \amp 2 \\
3 \amp 2 \amp -1 \\
\end{bmatrix}\)</span> is symmetric.  Since <span class="process-math">\(H=Q^TAQ\text{,}\)</span> we have</div>
<div class="displaymath process-math">
\begin{equation*}
H^T = (Q^TAQ)^T = Q^TA^TQ = Q^TAQ = H
\end{equation*}
</div>
<div class="para">showing that <span class="process-math">\(H\)</span> is symmetric too.  Since <span class="process-math">\(H\)</span> is also Hessenberg, this explains why <span class="process-math">\(H\)</span> is tridiagonal, which is seen by the presence of the <span class="process-math">\(0\)</span> in the first row, third column of <span class="process-math">\(H\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#example-arnoldi-1-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Example 3.3.1"><a href="#example-arnoldi" title="Copy heading and permalink for Example 3.3.1" aria-label="Copy heading and permalink for Example 3.3.1">🔗</a></div></article><div class="autopermalink" data-description="Subsection 3.3.1: Arnoldi iteration"><a href="#sec-arnoldi-3" title="Copy heading and permalink for Subsection 3.3.1: Arnoldi iteration" aria-label="Copy heading and permalink for Subsection 3.3.1: Arnoldi iteration">🔗</a></div></section><section class="subsection" id="sec-arnoldi-4"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.3.2</span><span class="space"> </span><span class="title">Krylov subspaces</span>
</h3>
<div class="para" id="sec-arnoldi-4-2">We will now explore how Arnoldi iteration can approximate the largest eigenvalues of an <span class="process-math">\(m\times m\)</span> matrix when <span class="process-math">\(m\)</span> is very large.  To begin, we recall that the power method, our first technique for approximating eigenvalues, begins with a randomly chosen vector <span class="process-math">\(\vvec\)</span> and repeatedly multiplies by <span class="process-math">\(A\)</span> to compute <span class="process-math">\(A^k\vvec\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-3">
<div class="para">One feature of the power method is that it is “forgetful.” That is, we compute lots of vectors <span class="process-math">\(A^k\vvec\text{,}\)</span> but at every step we only use the last one.  Perhaps we could do better if we remembered all the vectors.  This is the motivation for considering a <a href="sec-polys.html#definition-krylov" class="xref" data-knowl="./knowl/xref/definition-krylov.html" data-reveal-label="Reveal" data-close-label="Close" title="Definition 1.4.22: Krylov subspace">Krylov subspace</a>:</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/definition-krylov.html">
\begin{equation*}
\kcal_n(A,\vvec) = \laspan{\vvec, A\vvec,\ldots,A^{n-1}\vvec}
\end{equation*}
</div>
<div class="para">and its associated <dfn class="terminology">Krylov matrix</dfn>
</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/definition-krylov.html">
\begin{equation*}
K_n = \begin{bmatrix}
\vvec \amp A\vvec \amp \ldots \amp A^{n-1}\vvec
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-4">
<div class="para">You may remember that we introduced Krylov subspaces when we constructed the minimal polynomial of a vector <span class="process-math">\(\vvec\text{.}\)</span> Notice that we have the inclusion of subspaces</div>
<div class="displaymath process-math" id="equation-inclusions">
\begin{equation}
\kcal_1 \subset \kcal _2 \subset \ldots \subset \kcal_n\tag{3.3.1}
\end{equation}
</div>
<div class="para">and that these begin as proper inclusions <span class="process-math">\(\kcal_j\subsetneq\kcal_{j+1}\)</span> until the vectors</div>
<div class="displaymath process-math">
\begin{equation*}
\vvec, A\vvec, \ldots, A^\nu\vvec
\end{equation*}
</div>
<div class="para">become linearly dependent.  We said that <span class="process-math">\(\nu\)</span> is the <dfn class="terminology">grade</dfn> of <span class="process-math">\(\vvec\)</span> and noted that a non-trivial linear relationship between these vectors led to the minimal polynomial <span class="process-math">\(p_\vvec\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-5">
<div class="para">Remember that <span class="process-math">\(p_\vvec\)</span> divides the minimal polynomial <span class="process-math">\(p\)</span> of <span class="process-math">\(A\text{.}\)</span>  If <span class="process-math">\(\deg(p_\vvec) \lt
\deg(p)\text{,}\)</span> then <span class="process-math">\(\vvec\)</span> is in <span class="process-math">\(\nul(p_\vvec(A))\text{,}\)</span> a proper subspace of <span class="process-math">\(\real^m\text{.}\)</span>  The chances of choosing a vector in a given proper subspace is practically zero so we generally do not expect this to happen.  In other words, we expect the <a href="sec-arnoldi.html#equation-inclusions" class="xref" data-knowl="./knowl/xref/equation-inclusions.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.1">chain of proper inclusions</a> to continue for a long time so we assume that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/equation-inclusions.html">
\begin{equation*}
\dim\kcal_n = \dim(\col(K_n) = n\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="proposition theorem-like" id="sec-arnoldi-4-6"><h4 class="heading">
<span class="type">Proposition</span><span class="space"> </span><span class="codenumber">3.3.2</span><span class="period">.</span>
</h4>
<div class="para" id="sec-arnoldi-4-6-1-1">Suppose we apply Arnoldi iteration to the matrix <span class="process-math">\(K_n\)</span> to produce an orthogonal matrix <span class="process-math">\(Q_n=\begin{bmatrix}\qvec_1\amp\ldots\amp\qvec_n\end{bmatrix}\text{.}\)</span> Then <span class="process-math">\(K_n=Q_nR\)</span> where <span class="process-math">\(R\)</span> is upper triangular and <span class="process-math">\(Q_n\)</span> is an orthonormal basis for the Krylov subspace <span class="process-math">\(\kcal_n=\col(K_n)\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-6-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proposition 3.3.2"><a href="#sec-arnoldi-4-6" title="Copy heading and permalink for Proposition 3.3.2" aria-label="Copy heading and permalink for Proposition 3.3.2">🔗</a></div></article><article class="proof" id="sec-arnoldi-4-6-2"><h4 class="heading"><span class="type">Proof<span class="period">.</span></span></h4>
<div class="para logical" id="sec-arnoldi-4-6-2-1">
<div class="para">Recall that</div>
<div class="displaymath process-math">
\begin{equation*}
A\qvec_j = h_{1j}\qvec_1 + h_{2j}\qvec_2 + \ldots +
h_{j+1,j}\qvec_{j+1}\text{,}
\end{equation*}
</div>
<div class="para">which implies that</div>
<div class="displaymath process-math" id="equation-Aqvec">
\begin{equation}
A\qvec_j \in \laspan{\basis{\qvec}{j+1}}\text{.}\tag{3.3.2}
\end{equation}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-6-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-6-2-2">
<div class="para">Notice that <span class="process-math">\(A^0\vvec = \vvec = \len{\vvec}~\qvec_1\)</span> so that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/equation-Aqvec.html">
\begin{equation*}
A^0\vvec \in \laspan{\qvec_1}\text{.}
\end{equation*}
</div>
<div class="para">Now suppose that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/equation-Aqvec.html">
\begin{equation*}
A^{j-1}\vvec \in \laspan{\basis{\qvec}{j}}\text{.}
\end{equation*}
</div>
<div class="para">It then follows that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/equation-Aqvec.html">
\begin{equation*}
A^j\vvec \in \laspan{\basis{A\qvec}{j}} =
\laspan{\basis{\qvec}{j+1}}
\end{equation*}
</div>
<div class="para">where the equality of spans follows from <a href="sec-arnoldi.html#equation-Aqvec" class="xref" data-knowl="./knowl/xref/equation-Aqvec.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.2">(3.3.2)</a>.  This shows, by induction, that</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/equation-Aqvec.html">
\begin{equation*}
A^{j-1}\vvec \in \laspan{\basis{\qvec}{j}}
\end{equation*}
</div>
<div class="para">for all <span class="process-math">\(j\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-6-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-4-6-2-3">Since <span class="process-math">\(A^{j-1}\vvec\)</span> is the <span class="process-math">\(j^{th}\)</span> column of <span class="process-math">\(K_n\)</span> and is a linear combination of the first <span class="process-math">\(j\)</span> columns of <span class="process-math">\(Q_n\text{,}\)</span> it follows that <span class="process-math">\(K_n=Q_nR\)</span> where <span class="process-math">\(R\)</span> is upper triangular.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-6-2-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proof 3.3.2.1"><a href="#sec-arnoldi-4-6-2" title="Copy heading and permalink for Proof 3.3.2.1" aria-label="Copy heading and permalink for Proof 3.3.2.1">🔗</a></div></article><div class="para" id="sec-arnoldi-4-7">This proposition shows that Arnoldi iteration creates a <span class="process-math">\(QR\)</span> factorization of <span class="process-math">\(K_n\)</span> without explicitly constructing <span class="process-math">\(R\text{.}\)</span>  This is good fortune indeed!<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-8">
<div class="para">This analysis also provides some insight into a possible issue when running Arnoldi iteration.  Remembering that</div>
<div class="displaymath process-math">
\begin{equation*}
A\qvec_j = h_{1j}\qvec_1 + h_{2j}\qvec_2 + \ldots +
h_{j+1,j}\qvec_{j+1}\text{,}
\end{equation*}
</div>
<div class="para">the algorithm could break down if <span class="process-math">\(A\qvec_j\in\laspan{\basis{\qvec}{j}}\text{.}\)</span>  When this is the case, <span class="process-math">\(h_{j+1,j}\qvec_{j+1} = \zerovec\)</span> and hence <span class="process-math">\(\qvec_{j+1}\)</span> is not defined.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-4-9">
<div class="para">This can only happen, however, if <span class="process-math">\(A^j\vvec\)</span> is also in</div>
<div class="displaymath process-math">
\begin{equation*}
\laspan{\basis{\qvec}{j}} =
\laspan{\vvec,A\vvec,\ldots,A^{j-1}\vvec}\text{,}
\end{equation*}
</div>
<div class="para">which we have seen means that <span class="process-math">\(j=\nu\text{,}\)</span> the grade of <span class="process-math">\(\vvec\text{,}\)</span> and that <span class="process-math">\(p_\vvec\text{,}\)</span> the minimal polynomial of <span class="process-math">\(\vvec\text{,}\)</span> is a proper factor of the minimal polynomial of <span class="process-math">\(p\text{.}\)</span>  Since there are finitely many proper factors of <span class="process-math">\(p\text{,}\)</span> the chance that we randomly choose <span class="process-math">\(\vvec\)</span> in the null space of one of those factors is exceedingly rare.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-4-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.3.2: Krylov subspaces"><a href="#sec-arnoldi-4" title="Copy heading and permalink for Subsection 3.3.2: Krylov subspaces" aria-label="Copy heading and permalink for Subsection 3.3.2: Krylov subspaces">🔗</a></div></section><section class="subsection" id="sec-arnoldi-5"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.3.3</span><span class="space"> </span><span class="title">Eigenvalues and Arnoldi iteration</span>
</h3>
<div class="para" id="sec-arnoldi-5-2">We introduced Arnoldi iteration as a way of finding a Hessenberg matrix <span class="process-math">\(H\)</span> similar to <span class="process-math">\(A\text{.}\)</span>  Remember, however, that we would like to work with very large <span class="process-math">\(m\times
m\)</span> matrices for which it would not be practical to run the algorithm to completion.  Instead, we remember that the power method tells us that the Krylov subspaces contain information about the largest eigenvalues of <span class="process-math">\(A\text{.}\)</span>  Also, Arnoldi iteration is a process that, after each step, produces <span class="process-math">\(Q_n\)</span> an orthonormal basis for the Krylov subspace <span class="process-math">\(\kcal_n\)</span> where <span class="process-math">\(n\)</span> is usually much smaller than <span class="process-math">\(m\text{,}\)</span> the size of the matrix.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-5-3">
<div class="para">We will slightly reformulate the algebraic framework for Arnoldi iteration to focus on intermediate steps without expecting that it runs to completion.  Once again, we will have</div>
<div class="displaymath process-math">
\begin{equation*}
Q_n = \begin{bmatrix}
\qvec_1 \amp \qvec_2 \amp \ldots \amp \qvec_n
\end{bmatrix}\text{,}
\end{equation*}
</div>
<div class="para">which is an <span class="process-math">\(m\times n\)</span> matrix with <span class="process-math">\(n\leq m\text{.}\)</span> Multiplying the columns of <span class="process-math">\(Q\)</span> by <span class="process-math">\(A\)</span> gives the relations that we saw earlier:</div>
<div class="displaymath process-math" id="sec-arnoldi-5-3-6">
\begin{align*}
A\qvec_1 \amp = h_{11}\qvec_1 + h_{21}\qvec_2\\
A\qvec_2 \amp = h_{12}\qvec_1 + h_{22}\qvec_2 + h_{32}\qvec_3\\
\vdots \amp = \vdots\\
A\qvec_n \amp = h_{1n}\qvec_1 + h_{2n}\qvec_2 + \ldots +
h_{nn}\qvec_n + h_{n+1,n}\qvec_{n+1}\text{.}
\end{align*}
</div>
<div class="para">Notice the term <span class="process-math">\(h_{n+1,n}\qvec_{n+1}\)</span> in the expression for <span class="process-math">\(A\qvec_n\text{.}\)</span>  Putting all the coefficients <span class="process-math">\(h_{ij}\)</span> into a matrix results in the matrix</div>
<div class="displaymath process-math">
\begin{equation*}
\widetilde{H}_n = \begin{bmatrix}
h_{11} \amp h_{12} \amp h_{13} \amp \ldots \amp h_{1n} \\
h_{21} \amp h_{22} \amp h_{23} \amp \ldots \amp h_{2n} \\
0 \amp h_{32} \amp h_{33} \amp \ldots \amp h_{3n} \\
0 \amp 0 \amp h_{43} \amp \ldots \amp h_{4n} \\
\vdots \amp \vdots \amp \vdots \amp \ddots \amp \vdots \\
0 \amp 0 \amp 0 \amp \ldots \amp h_{n+1,n} \\
\end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">Notice that the shape of <span class="process-math">\(\widetilde{H}_n\)</span> is <span class="process-math">\((n+1)\times
n\)</span> so it is not square.  We do, however, have</div>
<div class="displaymath process-math">
\begin{equation*}
AQ_n = Q_{n+1}\widetilde{H}_n\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-5-4">
<div class="para">Here are some straightforward observations.</div>
<ul class="disc" id="sec-arnoldi-5-4-1">
<li id="sec-arnoldi-5-4-1-1">
<div class="para" id="sec-arnoldi-5-4-1-1-1">Since the columns of <span class="process-math">\(Q_n\)</span> are orthonormal, we have <span class="process-math">\(Q_n^TQ_n = I_n\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-4-1-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-5-4-1-1" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-arnoldi-5-4-1-2">
<div class="para" id="sec-arnoldi-5-4-1-2-1">
<span class="process-math">\(Q_{n+1} = \begin{bmatrix}
Q_n \amp \qvec_{n+1}
\end{bmatrix}\)</span> so <span class="process-math">\(Q_n^TQ_{n+1} = \begin{bmatrix}
I_n \amp \zerovec\end{bmatrix}\text{.}\)</span>  That is, <span class="process-math">\(Q_n^TQ_{n+1}\)</span> is an <span class="process-math">\(n\times (n+1)\)</span> matrix with a column of zeros appended to the side of the <span class="process-math">\(n\times
n\)</span> identity matrix.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-4-1-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-5-4-1-2" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-arnoldi-5-4-1-3">
<div class="para" id="sec-arnoldi-5-4-1-3-1">If we define <span class="process-math">\(H_n = Q_n^TQ_{n+1}\widetilde{H}_n\text{,}\)</span> then <span class="process-math">\(H_n\)</span> is a square <span class="process-math">\(n\times n\)</span> matrix obtained from <span class="process-math">\(\widetilde{H}_n\)</span> by removing its last row.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-4-1-3-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-5-4-1-3" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
<li id="sec-arnoldi-5-4-1-4">
<div class="para logical" id="sec-arnoldi-5-4-1-4-1">
<div class="para">Because <span class="process-math">\(Q_{n+1}\widetilde{H}_n = AQ_n\text{,}\)</span> it also follows that</div>
<div class="displaymath process-math">
\begin{equation*}
H_n = Q_n^TAQ_n\text{.}
\end{equation*}
</div>
<div class="para">While this may appear to say that <span class="process-math">\(H_n\)</span> is similar to <span class="process-math">\(A\text{,}\)</span> remember than <span class="process-math">\(Q_n\)</span> is not square so this is not a similarity relationship.  It does suggest, however, that <span class="process-math">\(H_n\)</span> is “somewhat similar” to <span class="process-math">\(A\)</span> so that they may share some common features.</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-4-1-4-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Item"><a href="#sec-arnoldi-5-4-1-4" title="Copy heading and permalink for Item" aria-label="Copy heading and permalink for Item">🔗</a></div>
</li>
</ul>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-5-5">Our goal now is to work with an <span class="process-math">\(m\times m\)</span> matrix <span class="process-math">\(A\text{,}\)</span> which is possibly very large, and approximate its largest eigenvalues.  The power method tells us that the Krylov subspace <span class="process-math">\(\kcal_n\)</span> can be expected to have information about the largest eigenvalues of <span class="process-math">\(A\text{.}\)</span>  For this reason, we will use the Krylov subspace to create an approximation of <span class="process-math">\(A\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-arnoldi-5-6">
<div class="para">The Krylov subspace <span class="process-math">\(\kcal_n\)</span> is an <span class="process-math">\(n\)</span>-dimensional subspace of <span class="process-math">\(\real^n\)</span> so we can consider the orthogonal projection <span class="process-math">\(P_{\kcal_n}:\real^m \to \kcal_n\text{.}\)</span>  This leads us to form the approximating operator <span class="process-math">\(T_n:\kcal_n\to\kcal_n\)</span> by</div>
<div class="displaymath process-math">
\begin{equation*}
T_n(\xvec) = P_{\kcal n}A\xvec\text{.}
\end{equation*}
</div>
<div class="para">This is, <span class="process-math">\(T_n\)</span> multiplies a vector in <span class="process-math">\(\kcal_n\)</span> by <span class="process-math">\(A\)</span> and then projects it back into <span class="process-math">\(\kcal_n\text{.}\)</span>
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-5-7">Notice that <span class="process-math">\(A\)</span> defines an operator on <span class="process-math">\(\real^m\)</span> where <span class="process-math">\(m\)</span> is huge, while <span class="process-math">\(T_n\)</span> defines an operator on an <span class="process-math">\(n\)</span>-dimensional space where <span class="process-math">\(n\)</span> is possibly much smaller than <span class="process-math">\(m\text{.}\)</span> Therefore, the operator <span class="process-math">\(T_n\)</span> is an approximation to <span class="process-math">\(A\)</span> on a much lower dimensional subspace <span class="process-math">\(\kcal_n\)</span> that has important information about the largest eigenvalues of <span class="process-math">\(A\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<article class="proposition theorem-like" id="sec-arnoldi-5-8"><h4 class="heading">
<span class="type">Proposition</span><span class="space"> </span><span class="codenumber">3.3.3</span><span class="period">.</span>
</h4>
<div class="para logical" id="sec-arnoldi-5-8-1-1">
<div class="para">If <span class="process-math">\(\bcal\)</span> is the orthonormal basis <span class="process-math">\(\basis{\qvec}{n}\)</span> for <span class="process-math">\(\kcal_n\text{,}\)</span> then the matrix representing <span class="process-math">\(T_n\)</span> is</div>
<div class="displaymath process-math">
\begin{equation*}
\coords{T_n}{\bcal} = H_n\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-8-1-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proposition 3.3.3"><a href="#sec-arnoldi-5-8" title="Copy heading and permalink for Proposition 3.3.3" aria-label="Copy heading and permalink for Proposition 3.3.3">🔗</a></div></article><article class="proof" id="sec-arnoldi-5-8-2"><h4 class="heading"><span class="type">Proof<span class="period">.</span></span></h4>
<div class="para logical" id="sec-arnoldi-5-8-2-1">
<div class="para">Since <span class="process-math">\(\basis{\qvec}{n}\)</span> is an orthonormal basis for <span class="process-math">\(\kcal_n\text{,}\)</span> the orthogonal projection <span class="process-math">\(P_{\kcal_n}\)</span> is given by <span class="process-math">\(Q_nQ_n^T\text{,}\)</span> which says that</div>
<div class="displaymath process-math">
\begin{equation*}
T_n\xvec = Q_nQ_n^TA\xvec\text{.}
\end{equation*}
</div>
<div class="para">Now the change of basis relationships tell us that <span class="process-math">\(\xvec=Q_n\coords{\xvec}{\bcal}\)</span> and <span class="process-math">\(\coords{T_n\xvec}{\bcal} = Q_n^{-1}T_n\xvec =
Q_n^TT_n\xvec\text{.}\)</span> Putting this together, we have</div>
<div class="displaymath process-math" id="sec-arnoldi-5-8-2-1-8">
\begin{align*}
\coords{T_n\xvec}{\bcal} \amp = Q_n^TT_n\xvec\\
\amp = Q_n^TQ_nQ_n^TA\xvec\\
\amp = Q_n^TAQ_n\coords{\xvec}{\bcal}\\
\amp = H_n\coords{\xvec}{\bcal}\text{.}
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-8-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Proof 3.3.3.1"><a href="#sec-arnoldi-5-8-2" title="Copy heading and permalink for Proof 3.3.3.1" aria-label="Copy heading and permalink for Proof 3.3.3.1">🔗</a></div></article><div class="para" id="sec-arnoldi-5-9">This remarkable turn of events shows us that Arnoldi iteration provides the perfect tool for approximating the largest eigenvalues of <span class="process-math">\(A\text{.}\)</span>  The operator <span class="process-math">\(T_n\)</span> approximates <span class="process-math">\(A\)</span> on a subspace with information about the largest eigenvalues and the matrix <span class="process-math">\(H_n\text{,}\)</span> which is formed by Arnoldi iteration, represents the operator <span class="process-math">\(T_n\text{.}\)</span>  This leads us to suspect that<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<blockquote class="blockquote" id="sec-arnoldi-5-10">
<em class="emphasis">The eigenvalues of <span class="process-math">\(H_n\)</span> approximate the largest eigenvalues of <span class="process-math">\(A\text{.}\)</span></em><div class="autopermalink" data-description="Quotation"><a href="#sec-arnoldi-5-10" title="Copy heading and permalink for Quotation" aria-label="Copy heading and permalink for Quotation">🔗</a></div>
</blockquote>
<div class="para" id="sec-arnoldi-5-11">The eigenvalues of <span class="process-math">\(H_n\)</span> are called <dfn class="terminology">Ritz values</dfn>.  Since <span class="process-math">\(H_n\)</span> is an <span class="process-math">\(n\times n\)</span> matrix and <span class="process-math">\(n\)</span> is much smaller than <span class="process-math">\(m\text{,}\)</span> we can use a conventional technique, such as the <em class="emphasis">QR</em> algorithm to find the Ritz values.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-5-11" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.3.3: Eigenvalues and Arnoldi iteration"><a href="#sec-arnoldi-5" title="Copy heading and permalink for Subsection 3.3.3: Eigenvalues and Arnoldi iteration" aria-label="Copy heading and permalink for Subsection 3.3.3: Eigenvalues and Arnoldi iteration">🔗</a></div></section><section class="subsection" id="sec-arnoldi-6"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.3.4</span><span class="space"> </span><span class="title">A working example</span>
</h3>
<div class="para" id="sec-arnoldi-6-2">We will demonstrate these ideas computationally.  We will first construct a <span class="process-math">\(100\times 100\)</span> matrix <span class="process-math">\(A\)</span> and plot its eigenvalues.  Of course, this is not a particularly large matrix, certainly not of the size we have imagined in this discussion, but it is big enough to demonstrate the central ideas.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-6-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-arnoldi-6-3">Evaluate the following cell and you will see a plot of <span class="process-math">\(100\)</span> eigenvalues in the complex plane.  For the most part, the eigenvalues are spread uniformly throughout a disk though there are a couple of eigenvalues of relatively large magnitude along the positive real axis.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-6-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div id="sec-arnoldi-6-4" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">import matplotlib.pyplot as plt
import numpy as np

def arnoldi(A, v, n):
    m = A.nrows()
    q_list = []
    h = np.zeros((n+1,n))
    v = 1/v.norm() * v
    q_list.append(v)
    for col in range(n):
        v = A*v
        for j, q in enumerate(q_list):
            h[j][col] = q * v
            v = v - h[j][col] * q
            v = vector(v)
        h[col+1][col] = v.norm()
        v = 1/v.norm() * v
        q_list.append(v)
    if len(q_list) > m:
        q_list.pop(-1)
        h = h[:-1]
    return matrix(q_list).T, matrix(h)

def e1(m):
    v_entries = [0] * m
    v_entries[0] = 1
    v = vector(v_entries)
    return v

def buildA(m):
    np.random.seed(1)
    A = np.random.randn(m, m)/np.sqrt(m)
    A[0][0]=1.5
    A[1][1]=1.3
    A[2][2]=1
    A = matrix(A)
    return A

def plot_eigenvalues(A, size=4, color='0'):
    ev = np.array(A.eigenvalues())
    plt.scatter(ev.real, ev.imag, s=size, c=color)
    
m = 100
A = buildA(m)
fig, ax = plt.subplots()
plot_eigenvalues(A)
plt.show()
</script></div>
<div class="para" id="sec-arnoldi-6-5">Evaluating the next cell performs 6 steps of Arnoldi iteration to produce a <span class="process-math">\(6\times 6\)</span> matrix <span class="process-math">\(H_n\text{,}\)</span> which is displayed to demonstrate its Hessenberg form.  (This cell and the next assume that the previous cell has been recently evaluated.)<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-6-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div id="sec-arnoldi-6-6" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">n = 6
Q, H = arnoldi(A, e1(m), n)
H = H.matrix_from_rows(range(n))
print(N(H, digits=5))
</script></div>
<div class="para" id="sec-arnoldi-6-7">Next we plot the eigenvalues of <span class="process-math">\(H_n\text{,}\)</span> which we call the Ritz values, and compare them to the eigenvalues of <span class="process-math">\(A\text{.}\)</span>  We begin with a small value of <span class="process-math">\(n=3\text{,}\)</span> but you should experiment by increasing the value of <span class="process-math">\(n\)</span> and noting how the Ritz values approximate the largest eigenvalues.  Note what happens when <span class="process-math">\(n=10,20,50\text{,}\)</span> for instance.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-6-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div id="sec-arnoldi-6-8" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">n = 3
Q, H = arnoldi(A, e1(m), n)
H = H.matrix_from_rows(range(n))
fig, ax = plt.subplots()
plot_eigenvalues(A)
plot_eigenvalues(H, size=15, color="r")
plt.show()
</script></div>
<div class="para" id="sec-arnoldi-6-9">To restate the main idea, we assume that <span class="process-math">\(A\)</span> is so large that it is not possible to directly compute its eigenvalues. Instead, we approximate <span class="process-math">\(A\)</span> by <span class="process-math">\(H_n\)</span> when <span class="process-math">\(n\)</span> is relatively small so that its eigenvalues can be computed through traditional means.  We see that the eigenvalues of <span class="process-math">\(H_n\)</span> approximate the large eigenvalues of <span class="process-math">\(A\)</span> and that the accuracy of the approximations improve as <span class="process-math">\(n\)</span> grows.<div class="autopermalink" data-description="Paragraph"><a href="#sec-arnoldi-6-9" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.3.4: A working example"><a href="#sec-arnoldi-6" title="Copy heading and permalink for Subsection 3.3.4: A working example" aria-label="Copy heading and permalink for Subsection 3.3.4: A working example">🔗</a></div></section><div class="autopermalink" data-description="Section 3.3: Arnoldi iteration"><a href="#sec-arnoldi" title="Copy heading and permalink for Section 3.3: Arnoldi iteration" aria-label="Copy heading and permalink for Section 3.3: Arnoldi iteration">🔗</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-qr.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="backmatter.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
